plugin: amazon.aws.aws_ec2
regions:
  - us-east-1
filters:
  tag:Environment: dev     # only fetch instances with tag "Environment=dev"
keyed_groups:
  - prefix: tag
    key: Tags.Environment
hostnames:
  - public-ip-address      # Use public IP as hostname
  - private-ip-address
compose:
  ansible_host: public_ip_address





- name: EC2 dynamic inventory test
  hosts: tag_Environment_dev
  become: true
  tasks:
    - name: Print hostname
      debug:
        msg: "Running on {{ inventory_hostname }}"
