- name: check the background
  debug:
    msg: "OS: {{ansible_os_family}}, RAM : {{ansible_memtotal_mb}} :MB"
- name: install packages on Debian/Ubuntu if RAM > 512
  apt:
    name: "{{item}}"
    state: present
    update_cache: yes
  loop: "{{debian_packages}}"
  when:
    - ansible_os_family == "Debian"
    - ansible_memtotal_mb >= min_required_ram_mb

- name: install packages on RHEL/Centos if RAM > 512
  yum:
    name: "{{item}}"
    state: present
    update_cache: yes
  loop: "{{redhat_packages}}"
  when:
    - ansible_os_family == "RedHat"
    - ansible_memtotal_mb >= min_required_ram_mb
    



----

- import_tasks: subtask.yaml

- name: uninstall apache from remote
  apt:
    name: apache2
    state: absent
  when: install_apache_flag

- name: check OS value
  debug:
    var: ansible_facts['kernel_version']
  when:
    - ansible_facts['os_family'] =='Debian'
    - ansible_facts['distribution_major_version'] >="20"

- name: read the file and take a call
  command: cat /home/ubuntu/userdetails.txt
  register: data

- name: print the data if user found
  debug:
    var: data.stdout
  when: data.stdout.find('superuser') != -1
